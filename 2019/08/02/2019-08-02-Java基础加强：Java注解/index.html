<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="description" content="WisdowsBlog,如果人生有遗憾，那就是没有早点遇到你~">
  <meta name="author" content="Wisdows">
  <meta name="keywords" content="Wisdows, 饶弟, WisdowsBlog, 王者★孤傲">
  <title>Java基础加强：Java注解 WisdowsBlog WisdowsBlog</title>

  <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"  >
<link rel="stylesheet" href="/lib/bootstrap/css/bootstrap.min.css"  >
<link rel="stylesheet" href="/lib/mdbootstrap/css/mdb.min.css"  >
<link rel="stylesheet" href="/lib/github-markdown/github-markdown.min.css"  >
<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css"  >

<link rel="stylesheet" href="/css/main.css"  >


  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox.min.css"  >


<link rel="alternate" href="/atom.xml" title="WisdowsBlog" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>WisdowsBlog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
        
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">Archives</a>
          </li>
        
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">Categories</a>
          </li>
        
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">Tags</a>
          </li>
        
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">About</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>


</nav>

    <div class="view intro-2" id="background"
         style="background: url('/img/16.jpg')no-repeat center center;
           background-size: cover;
           background-attachment: fixed;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              <br>
              
                <p class="mt-3">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>&nbsp;
                  星期五, 八月 2日 2019, 6:00 晚上
                </p>
              

              <p>
                
                  
                  &nbsp;<i class="far fa-chart-bar"></i>
                  <span class="post-count">
                    8k 字
                  </span>&nbsp;
                

                
                  
                  &nbsp;<i class="far fa-clock"></i>
                  <span class="post-count">
                      31 分钟
                  </span>&nbsp;
                

                
                  <!-- 不蒜子统计文章PV -->
                  
                  &nbsp;<i class="far fa-eye" aria-hidden="true"></i>&nbsp;
                  <span id="busuanzi_container_page_pv">
                    <span id="busuanzi_value_page_pv"></span> 次
                  </span>&nbsp;
                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="py-5 z-depth-3" id="board">
        <div class="post-content mx-auto" id="post">
          <div class="markdown-body">
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>上篇我们讲述了框架中核心技术 Java 反射 的使用，介绍了它功能的强大之处。</p>
<p>本篇我们讲述另一个框架使用的重要技术，<strong>Java 注解</strong></p>
<a id="more"></a>

<h2 id="1-什么是注解"><a href="#1-什么是注解" class="headerlink" title="1. 什么是注解"></a>1. 什么是注解</h2><h3 id="1-1-基本介绍"><a href="#1-1-基本介绍" class="headerlink" title="1.1 基本介绍"></a>1.1 基本介绍</h3><p>注解（Annotation），也叫元数据。一种代码级别的说明。它是 <strong>JDK1.5</strong> 及以后版本引入的一个特性，与类、接口、枚举是在同一个层次。它可以声明在包、类、字段、方法、局部变量、方法参数等的前面，用来对这些元素进行说明。</p>
<p>举个例子，注释我们都知道，注释是对程序的一些说明，是为了让程序员看得懂程序而编写的。</p>
<p>而注解也是对程序的说明，不过是给计算机看的，计算机通过注解得到信息，可以把注解理解为标签，给类、方法、成员变量贴上标签，对他们进行一些说明。</p>
<p>在使用 Junit 单元测试时，我们在每一个单元测试的方法上都要加上一个<code>@Test</code> 注解，这个注解就是告诉测试程序这个方法是测试方法，是可以用作单元测试的，可以直接运行：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * 测试add方法</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testAdd(){</span><br><span class="line">        //1.创建计算器对象</span><br><span class="line">        Calculator ca = new Calculator();</span><br><span class="line">        //调用add方法</span><br><span class="line">        int result = ca.add(1,3);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>



<h3 id="1-2-注解的基本结构"><a href="#1-2-注解的基本结构" class="headerlink" title="1.2 注解的基本结构"></a>1.2 注解的基本结构</h3><p>接下来我们从源码找寻注解的结构。</p>
<p>首先我们查看 SuppressWarnings 注解内部内容：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>({TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE})</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SuppressWarnings {</span><br><span class="line"></span><br><span class="line">    String[] value();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>可以看到，里面的结构为两个注解 + 一个用@interface声明的名称，该名称<code>{}</code>范围中还有一个类似方法定义的<code>String[] value()</code>。</p>
<h4 id="1-2-1-注解定义分析"><a href="#1-2-1-注解定义分析" class="headerlink" title="1.2.1 注解定义分析"></a>1.2.1 注解定义分析</h4><p>首先我们看<code>@interface</code> ，它其实是一种标识符，标识声明为一个注解，就如同<code>class</code>标识为声明为类一样。</p>
<p>那么 @interface 内部到底是如何实现注解定义的呢，我们可以通过反编译查看其中的内容，首先我们在任意目录下新建一个 MyAnno.java 文件，然后打开命令行窗口并定位到该目录，执行以下命令：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javac MyAnno.java <span class="comment">//编译形成class文件</span></span><br><span class="line">javap MyAnno<span class="class">.<span class="keyword">class</span> //反编译</span></span><br></pre></td></tr></tbody></table></figure>

<p>可以看到在执行第二条命令的下面出现以下代码信息：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Compiled from <span class="string">"MyAnno.java"</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MyAnno</span> <span class="keyword">extends</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">annotation</span>.<span class="title">Annotation</span> </span>{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>看到这里我们就很熟悉了，这不就是声明了一个名字为 MyAnno 的接口然后继承了 <code>java.lang.annotation.Annotation</code> 吗，那么 <code>java.lang.annotation.Annotation</code> 是啥，我们打开API文档，搜索 Annotation ，可以看到这么一段内容：</p>
<blockquote>
<ul>
<li>public interface Annotation</li>
</ul>
<p>所有注解类型扩展的公共接口。  注意，手动扩展这个接口不限定注解类型。 还要注意，此接口本身并不定义注解类型。  有关注解类型的更多信息，请参见The Java™ Language Specification的第9.6 节  。 <a href="../../../java/lang/reflect/AnnotatedElement.html"><code>AnnotatedElement</code></a>接口讨论了将注解类型从不可重复性转变为可重复时的兼容性问题。  </p>
</blockquote>
<p>到这基本就清楚了，@interface 用来定义一个注解，而且注解底层本质是一个接口，所有注解默认继承了 <code>java.lang.annotation.Annotation</code>接口  当然要注意，<strong>注解不支持继承</strong>，不可以使用 extends 关键字继承自 @interface 。</p>
<h4 id="1-2-2-元注解"><a href="#1-2-2-元注解" class="headerlink" title="1.2.2 元注解"></a>1.2.2 元注解</h4><p>我们再观察上面两个注解 @Target 和 @Retention 。</p>
<p><code>@Target</code>，<code>@Retention</code>两个注解其实是由 Java 提供的 <strong>元注解</strong> ，所谓元注解就是注解的注解，可能有点懵，我这样解释一下：</p>
<p>比如在类上面使用注解是表述类或描述类的一些信息，而<strong>元注解在注解中的使用就是用来表述或定义注解的一些信息</strong>。下面我们分别对这两个元注解进行分析。</p>
<ul>
<li><p><strong>@Target注解</strong></p>
<p>查看 @Target 注解的内容如下：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Target {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns an array of the kinds of elements an annotation type</span></span><br><span class="line"><span class="comment">     * can be applied to.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> an array of the kinds of elements an annotation type</span></span><br><span class="line"><span class="comment">     * can be applied to</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//返回注释类型的元素种类的数组</span></span><br><span class="line">    ElementType[] value();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>可以看到注解内容中有一个 <code>ElementType[] value()</code> 。</p>
<p>ElementType 为枚举类型，其作用是帮助我们在定义 Target 注解时指定传入的值，其中定义的内容如下：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line"> * <span class="meta">@author</span>  Joshua Bloch </span><br><span class="line"> * <span class="meta">@since</span> <span class="number">1.5</span> <span class="comment">// 1.5版本之后可用</span></span><br><span class="line"> * <span class="meta">@jls</span> <span class="number">9.6</span><span class="number">.4</span><span class="number">.1</span> <span class="meta">@Target</span> </span><br><span class="line"> * <span class="meta">@jls</span> <span class="number">4.1</span> The Kinds of Types and Values </span><br><span class="line"> */</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> ElementType {</span><br><span class="line">    <span class="comment">/** Class, interface (including annotation type), or enum declaration */</span></span><br><span class="line">    <span class="comment">//表明该注解可以用于类、接口、（包括注解类型）或枚举类型之上</span></span><br><span class="line">    TYPE,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Field declaration (includes enum constants) */</span></span><br><span class="line">    <span class="comment">//表明该注解可用于字段，包括enum常量之上</span></span><br><span class="line">    FIELD,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Method declaration */</span></span><br><span class="line">    <span class="comment">//表明该注解可用于方法之上</span></span><br><span class="line">    METHOD,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Formal parameter declaration */</span></span><br><span class="line">    <span class="comment">//表明该注解可用于方法参数之上</span></span><br><span class="line">    PARAMETER,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Constructor declaration */</span></span><br><span class="line">    <span class="comment">//表明可用于构造函数之上</span></span><br><span class="line">    CONSTRUCTOR,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Local variable declaration */</span></span><br><span class="line">    <span class="comment">//表明该注解可用于局部变量之上</span></span><br><span class="line">    LOCAL_VARIABLE,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Annotation type declaration */</span></span><br><span class="line">    <span class="comment">//表明该注解可用于注解之上</span></span><br><span class="line">    ANNOTATION_TYPE,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Package declaration */</span></span><br><span class="line">    <span class="comment">//表明该注解可以用于包之上</span></span><br><span class="line">    PACKAGE,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Type parameter declaration</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.8 从java 1.8 开始可用</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">     <span class="comment">//表明该注解可用于类型参数</span></span><br><span class="line">    TYPE_PARAMETER,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Use of a type</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.8 从java 1.8 开始可用</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">     <span class="comment">//表明该注解可用于类型使用</span></span><br><span class="line">    TYPE_USE</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p> 解释：</p>
<p>  Target 是目标的意思，@Target 就是约束注解可以使用的范围，例如我想约束注解只可作用于<strong>方法</strong>上，那么我就需要在注解的定义上声明如下：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注解作用于方法上</span></span><br><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AnnoBasic {</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>  Target 中的成员变量<code>ElementType[] value()</code>是一个数组，也就是意味着可以同时出传入多个类型相同但数值不同的值。</p>
<p>  例如我想使注解作用于类、方法、成员变量上，就可以这样定义：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注解作用于类、方法、成员变量上。</span></span><br><span class="line"><span class="meta">@Target</span>({ElementType.TYPE,ElementType.METHOD,ElementType.FIELD}) </span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AnnoBasic {</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>  不过在这里要注意使用大括号<code>{}</code>将这些属性括起来表示为数组。</p>
<p>  <strong>还有一点</strong>，当注解上没有使用 @Target 注解约束时，表示该注解可以作用于任何元素之上。</p>
</li>
<li><p><strong>@Retention注解</strong></p>
<p>查看@Retention注解的内容：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Retention {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the retention policy.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the retention policy</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//返回保留的策略</span></span><br><span class="line">    <span class="function">RetentionPolicy <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>类似 @Target 注解，这里也有一个成员属性值 value（），类型为<code>RetentionPolicy</code>。RetentionPolicy也是枚举类型，其中封装的值帮助我们定义@Retention注解指定传入的值，其中内容如下：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> RetentionPolicy {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Annotations are to be discarded by the compiler.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//表明注解被编译器丢弃（该类型的注解信息只会保留在源码里）</span></span><br><span class="line">    <span class="comment">//源码经过编译后，注解信息就会被丢弃，不会保留在class文件中</span></span><br><span class="line">    SOURCE,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Annotations are to be recorded in the class file by the compiler</span></span><br><span class="line"><span class="comment">     * but need not be retained by the VM at run time.  This is the default</span></span><br><span class="line"><span class="comment">     * behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//表明注解会被记录在class文件中，但VM（虚拟机）在运行时不会被保留该注解，该内容不会被加载到虚拟机中。</span></span><br><span class="line">    <span class="comment">//在不手动指定注解的生命周期时，默认注解声明周期都是该值</span></span><br><span class="line">    CLASS,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Annotations are to be recorded in the class file by the compiler and</span></span><br><span class="line"><span class="comment">     * retained by the VM at run time, so they may be read reflectively.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> java.lang.reflect.AnnotatedElement</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">   	<span class="comment">//表明该注解会被记录在class文件中而且在VM（虚拟机）运行时会被保留</span></span><br><span class="line">    <span class="comment">//虚拟机会加载class文件中的该注解的内容，可以使用反射机制读取该注解的内容</span></span><br><span class="line">   </span><br><span class="line">    RUNTIME</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>解释：</p>
<p>具体每个属性的信息可以查看上面的代码注释，说明的很清楚，我再说几点。</p>
<p>第一，类似@Override、@SuppressWarning这些对代码编写规范的提示类注解，他们的作用周期都是 SOURCE 也就是源码阶段。</p>
<p>第二，在目前的主流框架中，将注解定义为 RUNTIME 运行时时用的比较多的，如SpringMvc中的@Controller、@Autowired、@RequestMapping等。定义在运行时，我们可以通过反射获取注解的内容，可以简化代码。</p>
</li>
<li><p><strong>@Inherited注解</strong></p>
<p>@Inherited 负责指定注解可以被继承，但不是真正意义上的继承，<strong>注解本质上是不可以继承的</strong>，我们无法使用<code>extends</code>标识符继承自 @interface 。这里的继承指得是可以让子类通过反射使用Class对象中的getAnnotations() 获取父类被@Inherited修饰的注解，具体请看以下示例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> qianfanguojin</span></span><br><span class="line"><span class="comment"> *  /<span class="doctag">@Inherited</span>表明注解可继承的示例</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@Target</span>(ElementType.TYPE)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@interface</span> Anno1{</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> "Anno1被使用"</span>;</span><br><span class="line">    <span class="comment">//定义@Inherited的注解</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target</span>(ElementType.TYPE)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@interface</span> Anno2{</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> "Anno2被使用"</span>;</span><br><span class="line">    <span class="comment">//没有定义@Inherited的注解</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Anno</span>1</span><br><span class="line"><span class="meta">@Anno</span>2</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>{</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException </span>{</span><br><span class="line">        <span class="comment">//获得子类B的Class对象</span></span><br><span class="line">        Class cls = Class.forName(<span class="string">"cn.annotation.B"</span>);</span><br><span class="line">		<span class="comment">//获得子类B上面定义的所有注解（注意该注解是要定义在类的声明上面的）</span></span><br><span class="line">        Annotation[] ano = cls.getAnnotations();</span><br><span class="line">        <span class="keyword">for</span>(Annotation a : ano) {</span><br><span class="line">            <span class="comment">//获得的注解类型如果来自Anno1注解，输出该注解中value的值</span></span><br><span class="line">            <span class="keyword">if</span>(a <span class="keyword">instanceof</span> Anno1) {</span><br><span class="line">                System.out.println(((Anno1)a).value());</span><br><span class="line">            }</span><br><span class="line">            <span class="comment">//获得的注解类型如果来自Anno2注解，输出该注解中value的值</span></span><br><span class="line">            <span class="keyword">if</span> (a <span class="keyword">instanceof</span> Anno2) {</span><br><span class="line">                System.out.println(((Anno2)a).value());</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Anno1被使用</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><strong>@Documented</strong></p>
<p>说明该注解将被包含在javadoc中。和注释一样，注解虽然会在源码中显示，但是 javadoc 命令生成的文档默认会隐藏注解内容，如果我们想让某个注解在 javadoc 中可显示，在注解中定义即可，如：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 定义注解可以在java文档中出现</span><br><span class="line"> */</span><br><span class="line">@Documented</span><br><span class="line">@interface DO{</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>


</li>
</ul>
<h4 id="1-2-3-注解元素（属性）"><a href="#1-2-3-注解元素（属性）" class="headerlink" title="1.2.3 注解元素（属性）"></a>1.2.3 注解元素（属性）</h4><h5 id="p1-基本定义和使用"><a href="#p1-基本定义和使用" class="headerlink" title="p1. 基本定义和使用"></a>p1. 基本定义和使用</h5><p>在上面 @SuppressWarning 注解的定义内容中，有一个<code>String[] value()</code>。</p>
<p>这其实是注解的属性，或者说是元素。在前面的分析中，我们知道，注解的本质是一个接口，在接口中，我们可以定义抽象方法，在注解中我们同样可以，只不过在注解中，抽象方法被用来表示注解的元素。</p>
<p>于是在注解中注解元素的定义以 <strong>无形参的方法</strong> 形式声明，方法名定义了该元素的名字，返回值定义了该元素的类型。</p>
<p>在大多数自定义注解中，一般都会声明一些元素以标识某些值，方便程序使用，比如我们上面使用的 Target 注解，它在注解定义中定义了一个成员属性，那么我们就可以在声明注解的时候传入相关值来实现不同的效果：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(ElementType.METHOD) <span class="comment">//注解应用于方法上</span></span><br></pre></td></tr></tbody></table></figure>

<p>在注解定义中，支持如下的数据类型：</p>
<ul>
<li>所有的基本类型（int,float,boolean,byte,double,char,long,short）</li>
<li>String 字符串</li>
<li>Class 类对象</li>
<li>enum 枚举</li>
<li>Annotation 注解</li>
<li>上述类型的数组</li>
</ul>
<p>除以上的类型之外，在注解中不可使用其他类型或是说基础类型的包装类型如 <code>Integer</code>，不然编译器会报错。</p>
<p>还有一点就是和定义成员变量一样，注解元素也支持定义默认值，在某个元素定义了默认值后，我们在使用注解时可以不指定该元素的值。定义默认值方法是在定义的注解元素名后用 <code>defult</code> 指定。</p>
<p>使用示例如下：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.annotation;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="comment">//注解作用于类、方法、成员变量上。</span></span><br><span class="line"><span class="meta">@Target</span>({ElementType.TYPE,ElementType.METHOD,ElementType.FIELD})</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AnnoBasic {</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//注解作用于方法上</span></span><br><span class="line"><span class="comment">//@Target(ElementType.METHOD)</span></span><br><span class="line"><span class="comment">//public @interface AnnoBasic {</span></span><br><span class="line"><span class="comment">//}</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> qianfanhuojin</span></span><br><span class="line"><span class="comment"> * 对注解中可使用的元素类型示例</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@interface</span> AnnoElement{</span><br><span class="line">    <span class="comment">//基础类型 ，设定默认值都为0；</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">a</span><span class="params">()</span> <span class="keyword">default</span> 0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">float</span> <span class="title">b</span><span class="params">()</span> <span class="keyword">default</span> 0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">c</span><span class="params">()</span> <span class="keyword">default</span> 0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">d</span><span class="params">()</span> <span class="keyword">default</span> 0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//String 类型，默认值为空字符串</span></span><br><span class="line">    <span class="function">String <span class="title">e</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Class类型,默认值为void.class</span></span><br><span class="line">    <span class="function">Class <span class="title">f</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">void</span>.class</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//枚举类型,这里使用ElementType枚举类做示例,默认值为Element.TYPE</span></span><br><span class="line">    <span class="function">ElementType <span class="title">g</span><span class="params">()</span> <span class="keyword">default</span> ElementType.TYPE</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//注解类型，也就是可以使用嵌套注解，使用上面的注解AnnoBasic,默认值为@AnnoBasic</span></span><br><span class="line">    <span class="function">AnnoBasic <span class="title">h</span><span class="params">()</span> <span class="keyword">default</span> @AnnoBasic</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//数组</span></span><br><span class="line">    <span class="keyword">int</span>[] i() <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>注意两点：</p>
<ol>
<li><p>在定义默认值时要注意，编译器对注解属性的默认值使用规定非常严格。</p>
<p>首先是任何一个元素的默认值都不能设定为 <code>null</code>，在使用注解时也不能将元素的值指定为null ；其次是任一元素不能有不确定的值，要么在注解的定义中声明元素的默认值，不然就必须要在代码中使用注解时指定该元素的值。对于有些情况我们想让其表示为空时，只能用空自字符串或者是0等其他参数代替。</p>
</li>
<li><p>使用数组作为注解元素时，在使用该注解需要指定多个值时，需要用<code>{}</code>将数值包含起来，如：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>({ElementType.TYPE,ElementType.METHOD,ElementType.FIELD})</span><br></pre></td></tr></tbody></table></figure>



</li>
</ol>
<h5 id="p2-使用快捷方式指定注解元素的值"><a href="#p2-使用快捷方式指定注解元素的值" class="headerlink" title="p2. 使用快捷方式指定注解元素的值"></a>p2. 使用快捷方式指定注解元素的值</h5><p>在使用注解时，我们要指定注解元素的值，一般来说都是使用 <code>key=value</code> 的方式，比如：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AnnoElement</span>(a=<span class="number">1</span>,b=<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>但有的时候我们并不需要指定所有注解元素的值，或者说只有一个注解元素的值需要指定，在注解中提供了一个元素名为 <code>value()</code>的元素，只要在注解的定义中定义了名为 <code>value</code>的元素，我们在使用注解指定该值时就可以直接在括号中填入该值，最明显的一个案例就是 @Target 注解的内容：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Target {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns an array of the kinds of elements an annotation type</span></span><br><span class="line"><span class="comment">     * can be applied to.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> an array of the kinds of elements an annotation type</span></span><br><span class="line"><span class="comment">     * can be applied to</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//返回注释类型的元素种类的数组</span></span><br><span class="line">    ElementType[] value();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>定义了元素名为 value() 后，我们在使用时就可以直接填入该值的内容，如：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>({ElementType.TYPE,ElementType.METHOD,ElementType.FIELD})</span><br></pre></td></tr></tbody></table></figure>



<hr>
<h2 id="2-注解的基本使用"><a href="#2-注解的基本使用" class="headerlink" title="2. 注解的基本使用"></a>2. 注解的基本使用</h2><p>在 Java 中，注解的语法格式为： <code>@+注解名</code>，如<code>@Override</code>。</p>
<p>一般来说，注解的使用主要分为以下三类：</p>
<ul>
<li>编写文档。在代码的文档注释里使用 Java 提供的注解，然后使用 javadoc 命令生成doc文档。</li>
<li>编译检查。通过代码里标识的注解能够让编译器实现编译检查，如 【Override】命令检查是否为继承重写的方法。</li>
<li>代码分析。通过代码里标识的注解对代码进行分析，处理。</li>
</ul>
<p>在现代的主流框架中，如Spring ，大量使用了注解来简化代码，那么现在我们就来分析注解具体的一些我们应该学习的地方。</p>
<h3 id="2-1-使用注解编写文档"><a href="#2-1-使用注解编写文档" class="headerlink" title="2.1 使用注解编写文档"></a>2.1 使用注解编写文档</h3><p>使用 Java 时，我们经常会遇到自己不认识的类或者是某个方法我们不知道具体是做什么用的，此时我们都知道可以翻阅 java 的 api 文档查看，如 java8 的文档：</p>
<p><img src="/img/JavaAnnotation/01.png" srcset="undefined" alt=""></p>
<p>那么这些文档怎么生成的呢？</p>
<p>其实这些都是使用 javadoc 命令通过解析代码中的文档注释以及相关注解自动生成的网页。</p>
<p>现在我们用一个简单的例子测试以下：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 注解生成 Javadoc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 千帆过烬</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.5</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnoDocDemo</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 计算两数的和</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> a 整数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> b	整数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 两数的和</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> a , <span class="keyword">int</span> b)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>然后在 AnnoDocDemo.java 文件所在目录打开命令行窗口，执行：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javadoc AnnoDocDemo.java</span><br></pre></td></tr></tbody></table></figure>

<p>此时在目录下会生成许多网页相关的文件：</p>
<p><img src="/img/JavaAnnotation/02.png" srcset="undefined" alt=""></p>
<p>然后我们打开 index.html 可以看到：</p>
<p><img src="/img/JavaAnnotation/03.png" srcset="undefined" alt=""></p>
<p>生成了跟我们的 api 文档一样的样子，而且刚才我们定义的注解都被解析成文档的格式</p>
<p>如<code>@since</code> 表示从何版本开始，方法中的<code>@return</code> 表示对返回值的解释。</p>
<p>当然在文档注释中可以使用的注解不止这些，通过使用这些注解可以帮助 javadoc命令 在生成文档的时候根据注解内容来生成不同的文档内容。也就是说，注解能让 java 程序通过注解得到程序想要的信息。</p>
<h3 id="2-2-JDK-内置的一些注解"><a href="#2-2-JDK-内置的一些注解" class="headerlink" title="2.2 JDK 内置的一些注解"></a>2.2 JDK 内置的一些注解</h3><p>在 JDK 中预置的三个常用注解为：</p>
<ol>
<li><p><code>@Override</code> ：检测该被注解标注的方法是否是继承自父类（接口）的。</p>
<p>源码为：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Override {</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="2">
<li><p><code>@Deprecated</code>：被该注解标注的内容，表示已经过时。</p>
<p>源码为：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(value={CONSTRUCTOR, FIELD, LOCAL_VARIABLE, METHOD, PACKAGE, PARAMETER, TYPE})</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Deprecated {</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="3">
<li><p><code>@SuppressWarning</code>：有选择的关闭编译器对类、方法、成员变量、变量初始警告。</p>
<p>源码为：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>({TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE})</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SuppressWarnings {</span><br><span class="line">    String[] value();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>内部的 String 数组接收的值如下：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">deprecation：使用了不赞成使用的类或方法时的警告；</span><br><span class="line">unchecked：执行了未检查的转换时的警告，例如当使用集合时没有用泛型 (Generics) 来指定集合保存的类型; </span><br><span class="line">fallthrough：当 Switch 程序块直接通往下一种情况而没有 Break 时的警告;</span><br><span class="line">path：在类路径、源文件路径等中有不存在的路径时的警告; </span><br><span class="line">serial：当在可序列化的类上缺少 serialVersionUID 定义时的警告; </span><br><span class="line">finally：任何 finally 子句不能正常完成时的警告; </span><br><span class="line">all：关于以上所有情况的警告。</span><br></pre></td></tr></tbody></table></figure>



</li>
</ol>
<p>使用介绍如下：</p>
<h4 id="2-2-1-Override"><a href="#2-2-1-Override" class="headerlink" title="2.2.1 @Override"></a>2.2.1 @Override</h4><p>首先是<code>@Override</code>注解，添加如下代码</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. `<span class="doctag">@Override</span>` ：检测该被注解标注的方法是否是继承自父类（接口）的。</span></span><br><span class="line"><span class="comment"> * 2. `<span class="doctag">@Deprecated</span>`：被该注解标注的内容，表示已经过时。</span></span><br><span class="line"><span class="comment"> * 3. `<span class="doctag">@SuppressWarning</span>`：压制（忽略）警告。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnoJdk</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * /<span class="doctag">@Override</span>注解是对代码的一种严谨性检查</span></span><br><span class="line"><span class="comment">     * 在方法上声明该注解能够确保方法是重写自父类的</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//声明了Override注解后，该方法必须在父类中存在</span></span><br><span class="line">    <span class="comment">//所有的类都继承了Object类，toString方法在Object类中，这里不报错</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.toString();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这里会报错</span></span><br><span class="line">    <span class="comment">//声明了@Oerride注解后，该方法必须在父类能够找到，toString1方法在父类中不存在</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString1</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/img/JavaAnnotation/04.png" srcset="undefined" alt=""></p>
<p>可以看到，编辑器报错，并提示 <code>Method dose not override method from its superclass</code> 也就是该方法不是重写父类的，声明<code>@Override注解</code>会报错。</p>
<h4 id="2-2-2-Deprecated"><a href="#2-2-2-Deprecated" class="headerlink" title="2.2.2 @Deprecated"></a>2.2.2 @Deprecated</h4><p>其次是<code>@Deprecated</code>注解，在刚才的文件中添加代码：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * /<span class="doctag">@Deprecated</span>注解对方法进行过时标记</span></span><br><span class="line"><span class="comment">     * 被该注解标识的方法在使用时会提示过时，在ide中该方法被画了一条线</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="comment">//旧的方法</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addnew</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="comment">//新的方法</span></span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>

<p>这时我们如果调用 <code>add（）</code> 方法时，会出现：</p>
<p><img src="/img/JavaAnnotation/05.png" srcset="undefined" alt=""></p>
<p>提示我们方法过时，在 Java 的发展中，强大的类库为我们提供了许多的方便，不过有些方法或类久了之后在程序中使用已经不再推荐，如 Java 中的 Data 类z中的许多方法：</p>
<p><img src="/img/JavaAnnotation/06.png" srcset="undefined" alt=""></p>
<p>A <a href="#this-is-a-title">link</a> to jump towards target header</p>
<h4 id="2-2-3-SuppressWarning"><a href="#2-2-3-SuppressWarning" class="headerlink" title="2.2.3 @SuppressWarning"></a>2.2.3 @SuppressWarning</h4><p>最后是<code>@SuppressWarning</code>注解，我们在编辑器编写代码时候，如：</p>
<p><img src="/img/JavaAnnotation/07.png" srcset="undefined" alt=""></p>
<p>这里每一小点点都是编译器帮我们检查出来的一些可能的问题，编辑器会以一些方式来提醒用户，但是有得时候警告可能很多，而且我们自己其实知道代码并没有什么问题，我们可以使用<code>@SuppressWarning</code>注解来压制警告。</p>
<p><code>@SuppressWarning</code>压制警告的范围和类型由自己决定，比如我想压制整个类的所有警告类型，我在类名上声明注解为:</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"all"</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>在类上声明，该注解会作用于整个类的区域，后面的字符串指定你要压制的类型，一般我们使用<code>al</code>即全部类型的警告，其余的属性请翻阅上面的 <a href="#2.2-JDK-内置的一些注解">JDK 内置的一些注解</a> （按住Ctrl + 鼠标左键跳转）。</p>
<hr>
<h2 id="3-注解进阶使用"><a href="#3-注解进阶使用" class="headerlink" title="3. 注解进阶使用"></a>3. 注解进阶使用</h2><h3 id="3-1-获取使用注解对象"><a href="#3-1-获取使用注解对象" class="headerlink" title="3.1 获取使用注解对象"></a>3.1 获取使用注解对象</h3><p>在使用自定注解之前，我们先来了解一下如何获取注解中的内容。</p>
<p>根据前面的知识，我们知道注解声明的位置是在类、方法、成员变量….等等之上，如果接触过反射的话，我们知道在程序的运行过程中我们可以通过反射机制获取类中的构造方法、成员方法、成员变量等，而注解也可以看作是类、方法、成员变量中的一部分。</p>
<p>为了在运行时准确的获取到注解的相关信息，Java 在java.lang.reflect 反射包下提供了AnnotatedElement 接口，反射我们使用的基本类如Method类、Constructor类、Field类、Class类和Package类都实现了该接口。</p>
<p>该接口中的方法及功能如下：</p>
<table>
<thead>
<tr>
<th align="center">方法返回值</th>
<th align="center">方法名</th>
<th align="center">方法功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>&lt;T extends Annotation&gt; T</code></td>
<td align="center"><code>getAnnotation(Class&lt;T&gt; annotationClass)</code></td>
<td align="center">返回该元素的指定注解类型的注解对象（包括继承自父类的），如找不到该注解类型，则返回 null。</td>
</tr>
<tr>
<td align="center"><code>Annotation[]</code></td>
<td align="center"><code>getAnnotations()</code></td>
<td align="center">返回该元素上所有存在的注解，包括继承至父类的。</td>
</tr>
<tr>
<td align="center"><code>default &lt;T extends Annotation&gt; T</code></td>
<td align="center"><code>getDeclaredAnnotation( Class &lt;T&gt; annotationClass )</code></td>
<td align="center">返回该元素的指定注解类型的注解对象，如找不到该注解类型，则返回 null，忽略继承自父类的注解。</td>
</tr>
<tr>
<td align="center"><code>Annotation[]</code></td>
<td align="center"><code>getDeclaredAnnotations()</code></td>
<td align="center">返回该元素上所有存在的注解，忽略继承至父类的注解。</td>
</tr>
<tr>
<td align="center"><code>default boolean</code></td>
<td align="center"><code>isAnnotationPresent( Class &lt;?  extends Annotation&gt; annotationClass )</code></td>
<td align="center">如果此元素上<em>存在</em>指定类型的注解(包括继承自父类的)，则返回true，否则返回false。  该方法主要用于方便访问标记注解。</td>
</tr>
</tbody></table>
<p>一个简单的使用案例如下：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.METHOD;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> qianfanguojin</span></span><br><span class="line"><span class="comment"> * 注解的简单示例</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@AH</span>1</span><br><span class="line"><span class="meta">@AH</span>2</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnnoGetH</span></span>{</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@A</span>1</span><br><span class="line"><span class="meta">@A</span>2</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnoGet</span> <span class="keyword">extends</span> <span class="title">AnnoGetH</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, NoSuchMethodException </span>{</span><br><span class="line">        <span class="comment">//获取AnnoGet类的Class对象</span></span><br><span class="line">        Class&lt;?&gt; aClass = Class.forName(<span class="string">"cn.annotation.AnnoGet"</span>);</span><br><span class="line">        <span class="comment">//由于我注解都是定义在类上面的</span></span><br><span class="line">        <span class="comment">//下面的注解都要用Class类对象来获取</span></span><br><span class="line">        <span class="comment">//相应的如果定义在方法上则要用方法Method对象获取</span></span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">"----------getAnnotation 获取该元素指定注解类型的注解对象,包含继承的----------"</span>);</span><br><span class="line">        A1 a1 = aClass.getAnnotation(A1<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">         <span class="comment">//获取继承自AnnoGetH类的注解</span></span><br><span class="line">        AH1 ah1 = aClass.getAnnotation(AH1<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        System.out.println(a1.toString());</span><br><span class="line">        System.out.println(ah1.toString());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"----------getAnnotations 获取该元素所有的注解对象，包含继承----------"</span>);</span><br><span class="line">        Annotation[] annotations = aClass.getAnnotations();</span><br><span class="line">        System.out.println(Arrays.toString(annotations));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"----------getDeclearedAnnotation 获取该元素指定注解类型的注解对象，忽略继承的----------"</span>);</span><br><span class="line">        A2 a2 = aClass.getDeclaredAnnotation(A2<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//此方法不能获取到继承的注解，否则会抛出异常</span></span><br><span class="line">        System.out.println(a2.toString());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"----------getDeclearedAnnotations 获取该元素所有的注解对象，忽略继承的----------"</span>);</span><br><span class="line">        Annotation[] annotations1 = aClass.getDeclaredAnnotations();</span><br><span class="line">        System.out.println(Arrays.toString(annotations1));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"----------isAnnotationPresent 判断该元素是否存在指定的注解对象，包括继承的----------"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//依次判断该元素是否有相应的注解</span></span><br><span class="line">            <span class="keyword">if</span> (aClass.isAnnotationPresent(A1<span class="class">.<span class="keyword">class</span>)) </span>{</span><br><span class="line">                System.out.println(<span class="string">"A1 true"</span>);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (aClass.isAnnotationPresent(A2<span class="class">.<span class="keyword">class</span>)) </span>{</span><br><span class="line">                System.out.println(<span class="string">"A2 true"</span>);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (aClass.isAnnotationPresent(AH1<span class="class">.<span class="keyword">class</span>)) </span>{</span><br><span class="line">                System.out.println(<span class="string">"AH1 true"</span>);</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (aClass.isAnnotationPresent(AH2<span class="class">.<span class="keyword">class</span>)) </span>{</span><br><span class="line">                System.out.println(<span class="string">"AH2 true"</span>);</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * AnnoH类的注解,可继承</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>({ElementType.TYPE, METHOD})</span><br><span class="line"><span class="meta">@interface</span> AH1{</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * AnnoH类的注解</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>({ElementType.TYPE, METHOD})</span><br><span class="line"><span class="meta">@interface</span> AH2{</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Anno类的注解</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>({ElementType.TYPE, METHOD})</span><br><span class="line"><span class="meta">@interface</span> A1{</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Anno类的注解</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>({ElementType.TYPE, METHOD})</span><br><span class="line"><span class="meta">@interface</span> A2{</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出的结果为：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">----------getAnnotation 获取该元素指定注解类型的注解对象,包含继承的----------</span><br><span class="line">@cn.annotation.A1()</span><br><span class="line">@cn.annotation.AH1()</span><br><span class="line">----------getAnnotations 获取该元素所有的注解对象，包含继承----------</span><br><span class="line">[@cn.annotation.AH1(), @cn.annotation.A1(), @cn.annotation.A2()]</span><br><span class="line">----------getDeclearedAnnotation 获取该元素指定注解类型的注解对象，忽略继承的----------</span><br><span class="line">@cn.annotation.A2()</span><br><span class="line">----------getDeclearedAnnotations 获取该元素所有的注解对象，忽略继承的----------</span><br><span class="line">[@cn.annotation.A1(), @cn.annotation.A2()]</span><br><span class="line">----------isAnnotationPresent 判断该元素是否存在指定的注解对象，包括继承的----------</span><br><span class="line">A1 true</span><br><span class="line">A2 true</span><br><span class="line">AH1 true</span><br></pre></td></tr></tbody></table></figure>

<p>要注意一点，虽然getAnnotations 和getAnnotation 都能获取到从父类继承的注解，但是父类的注解必须被声明 @inherited 注解，子类才能获取到该父类的注解。</p>
<h3 id="3-2-自定义注解实现对方法的测试"><a href="#3-2-自定义注解实现对方法的测试" class="headerlink" title="3.2 自定义注解实现对方法的测试"></a>3.2 自定义注解实现对方法的测试</h3><p>了解完注解的基础知识以及如何使用反射获取注解之后，我们通过一个例子自定义注解解决我们的问题。</p>
<p>假设小明写了一个类 Calculator  ，他自信满满的对我说：</p>
<p>小明：“像我这么优秀的人，我写的代码肯定是没有问题的”</p>
<p>我：“自信是好的，但是还是不要轻心，还是测试比较一下比较好的”</p>
<p>小明：“那你想怎么测试，一个个调用很麻烦的，还要一个个分析”</p>
<p>我：“不用，我只要使用注解@QTest就好了，你看我表现吧”</p>
<p>小明编写的类 <strong>Calculator</strong> ：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> qianfanguojin</span></span><br><span class="line"><span class="comment"> * 计算器类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Calculator</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">//减法</span></span><br><span class="line">    <span class="meta">@AnnoCheck</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span> <span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"1 + 0 ="</span> + (<span class="number">1</span> + <span class="number">0</span>));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//减法</span></span><br><span class="line">    <span class="meta">@AnnoCheck</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sub</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"1 - 0 ="</span> + (<span class="number">1</span> - <span class="number">0</span>));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//乘法</span></span><br><span class="line">    <span class="meta">@AnnoCheck</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mul</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"1 * 0 ="</span> + (<span class="number">1</span> * <span class="number">0</span>));</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//除法</span></span><br><span class="line">    <span class="meta">@AnnoCheck</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">div</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"1 / 0 ="</span> + (<span class="number">1</span> / <span class="number">0</span>));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showSuccess</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"啊哈哈，没有BUG"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>测试使用的注解 <strong>AnnoCheck</strong>：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AnnoCheck {</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>最后，我使用自己的测试类 CalculatorCheck 就可以测试 Calculator 类中的方法了：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> qianfanguojin</span></span><br><span class="line"><span class="comment"> * 测试类，对方法测试并生成测试信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CalculatorCheck</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>{</span><br><span class="line">        <span class="comment">//获取Calculator类的Class对象</span></span><br><span class="line">        Class cls = Class.forName(<span class="string">"cn.annotation.Calculator"</span>);</span><br><span class="line">        <span class="comment">//创建一个类实例用于运行方法</span></span><br><span class="line">        Calculator ca =  <span class="keyword">new</span> Calculator();</span><br><span class="line">        <span class="comment">//计算运行错误的次数</span></span><br><span class="line">        <span class="keyword">int</span> num = <span class="number">0</span> ;</span><br><span class="line">        <span class="comment">//打印结果的字符串</span></span><br><span class="line">        StringBuilder strb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="comment">//获取该类中的所有方法</span></span><br><span class="line">        Method[] methods = cls.getMethods();</span><br><span class="line">        <span class="keyword">for</span>(Method m: methods) {</span><br><span class="line">            <span class="comment">//判断该方法上是否有注解，有则是要测试的方法</span></span><br><span class="line">            <span class="keyword">if</span> (m.isAnnotationPresent(AnnoCheck<span class="class">.<span class="keyword">class</span>)) </span>{</span><br><span class="line">                <span class="comment">//测试的方法可能会有错误，我们应该捕获异常</span></span><br><span class="line">                <span class="keyword">try</span> {</span><br><span class="line">                    m.invoke(ca);</span><br><span class="line">                    strb.append(<span class="string">"方法: "</span> + m.getName() + <span class="string">" 运行成功\n"</span>);</span><br><span class="line">                }<span class="keyword">catch</span> (Exception e){</span><br><span class="line">                    num++;</span><br><span class="line">                    strb.append(<span class="string">"方法: "</span> + m.getName() + <span class="string">" 运行出现异常\n"</span>);</span><br><span class="line">                    strb.append(<span class="string">"异常名为："</span> + e.getCause().getClass().getSimpleName() + <span class="string">"\n"</span>);</span><br><span class="line">                    strb.append(<span class="string">"异常的原因："</span> + e.getCause().getMessage() + <span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        strb.append(<span class="string">"--------------------\n"</span>);</span><br><span class="line">        strb.append(<span class="string">"发现"</span> + num + <span class="string">"个错误！"</span>);</span><br><span class="line">        System.out.println(strb.toString());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出的结果为：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> + <span class="number">0</span> =<span class="number">1</span></span><br><span class="line"><span class="number">1</span> - <span class="number">0</span> =<span class="number">1</span></span><br><span class="line"><span class="number">1</span> * <span class="number">0</span> =<span class="number">0</span></span><br><span class="line">方法: add 运行成功</span><br><span class="line">方法: sub 运行成功</span><br><span class="line">方法: mul 运行成功</span><br><span class="line">方法: div 运行出现异常</span><br><span class="line">异常名为：ArithmeticException</span><br><span class="line">异常的原因：/ by zero</span><br><span class="line">--------------------</span><br><span class="line">发现<span class="number">1</span>个错误！</span><br></pre></td></tr></tbody></table></figure>

<p>可以看到，提示div 方法出现了异常，异常名为 ArithmeticException ，异常原因为除 0 操作。</p>
<p>小明的代码是有问题的，而我也通过注解完成了我的目的。</p>
<p>利用注解 + 反射的结合能帮我们解决平时看起来很复杂的问题，在目前的应用中，注解在各种框架中大放光彩，比如：</p>
<ul>
<li><p>JUnit 测试框架</p>
</li>
<li><p>Android 的 ButterKnife</p>
</li>
<li><p>Spring </p>
<p>….. </p>
</li>
</ul>
<h2 id="4-jdk-8-对注解功能的增强"><a href="#4-jdk-8-对注解功能的增强" class="headerlink" title="4. jdk 8 对注解功能的增强"></a>4. jdk 8 对注解功能的增强</h2><h3 id="4-1-新增元注解-Repeatable"><a href="#4-1-新增元注解-Repeatable" class="headerlink" title="4.1 新增元注解@Repeatable"></a>4.1 新增元注解@Repeatable</h3><p>@Repeatable 注解在Java 8 中加入，它表示的注解可以在同一个位置重复使用。比如：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Role</span>(<span class="string">"USER"</span>)</span><br><span class="line"><span class="meta">@Role</span>(<span class="string">"ADMIN"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>在 java8 之前，如果我们要实现一个注解表示多个相同类型但不同的值，我们必须要在注解内部声明数组，比如@Target注解：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Target {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns an array of the kinds of elements an annotation type</span></span><br><span class="line"><span class="comment">     * can be applied to.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> an array of the kinds of elements an annotation type</span></span><br><span class="line"><span class="comment">     * can be applied to</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//返回注释类型的元素种类的数组</span></span><br><span class="line">    ElementType[] value();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>我们在使用时在注解上只能声明一次 Target注解，然后指定多个值形成数组，来表示注解可以在多个地方使用:</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>({ElementType.TYPE,ElementType.METHOD,ElementType.FIELD})</span><br></pre></td></tr></tbody></table></figure>

<p>而Java8又提供了另一种解决方式：使用@Repeatable 注解表明该注解可以在同一元素上重复使用。假设我想使Role 注解可以重复声明在类上，实现这个功能需要两步：</p>
<p>第一步在 Role 注解上加@Repeatable注解，并指定多个重复的Role注解存放的容器，该容器也是一个注解类型：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Role注解，被允许重复使用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Repeatable</span>(Roles<span class="class">.<span class="keyword">class</span>) //指定该注解可以重复声明，并指定该注解声明后放置的容器注解</span></span><br><span class="line"><span class="class">@<span class="title">Retention</span>(<span class="title">RetentionPolicy</span>.<span class="title">RUNTIME</span>)</span></span><br><span class="line"><span class="class">@<span class="title">Target</span>(<span class="title">ElementType</span>.<span class="title">TYPE</span>)</span></span><br><span class="line"><span class="class">@<span class="title">interface</span> <span class="title">Role</span></span>{</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>第二步创建 Role注解的容器Roles注解，在Roles注解中声明一个 Role [] 注解数组存放多个Role注解：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Role注解的容器，接收相同的Role注解</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target</span>(ElementType.TYPE)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@interface</span> Roles{</span><br><span class="line">    Role[] value();<span class="comment">//数组负责保留多个Role注解</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>然后我们就可以在同一元素上使用Role注解了。</p>
<p>事实上这只是一种语法糖而已，我举个例子，假设我们在Person类上声明了两个相同Role注解：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Role</span>(<span class="string">"USER"</span>)</span><br><span class="line"><span class="meta">@Role</span>(<span class="string">"ADMIN"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>这两个 Role 注解会自动合并到 Roles 注解中，相当于这样定义一个Roles注解：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Roles</span>({<span class="meta">@Role</span>(<span class="string">"USER"</span>,<span class="meta">@Role</span>(<span class="string">"ADMIN"</span>))})</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>而事实是这样定义和上面定义的效果是一样的，上面的定义看起来可能就更直观一点。</p>
<p>为了处理这种重复注解，java8也在 AnnotatedElement 接口中新增了两个方法，用法如下：</p>
<table>
<thead>
<tr>
<th align="center">方法返回值</th>
<th align="center">方法名</th>
<th align="center">方法功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>default &lt;T extends Annotation&gt;T[]</code></td>
<td align="center"><code>getAnnotationsByType( Class&lt;T&gt; annotationClass)</code></td>
<td align="center">返回该元素上指定注解类型，重复使用的注解，包括继承自父类的。</td>
</tr>
<tr>
<td align="center"><code>default &lt;T extends Annotation&gt;T[]</code></td>
<td align="center"><code>getDeclaredAnnotationsByType(Class&lt;T&gt; annotationClass)</code></td>
<td align="center">返回该元素上指定注解类型，重复使用的注解，不包括继承自父类的。</td>
</tr>
</tbody></table>
<p><strong>注意：</strong></p>
<p>对于 getAnnotationsByType 方法，该方法会最先调用 getDeclaredAnnotationsByType 方法寻找当前元素（类，成员变量，成员方法）上是否有指定注解类型而且被重复声明的注解，如有则返回当前元素上定义的指定注解类型的所有注解。</p>
<p>如找不到，并且注解是声明在一个类上，而该注解又是可继承的(使用了@Inherited)，则就去父类寻找是否有指定注解类型重复声明的注解。</p>
<p>两者只能取一，意思是如果你开始获取到子类有指定注解类型的重复注解，那么就不会再去寻找父类是否有该指定类型的重复注解，子类找不到再去寻找父类。</p>
<p>简单的使用示例如下：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明两个重复注解</span></span><br><span class="line"><span class="meta">@Role</span>(<span class="string">"USER"</span>)</span><br><span class="line"><span class="meta">@Role</span>(<span class="string">"ADMIN"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">extends</span> <span class="title">Child</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException </span>{</span><br><span class="line">        Class&lt;?&gt; cls = Class.forName(<span class="string">"cn.annotation.Person"</span>);</span><br><span class="line">        Role[] annotationsByType = cls.getAnnotationsByType(Role<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="keyword">for</span> (Role r: annotationsByType){</span><br><span class="line">            System.out.println(r.toString());</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="comment">//声明两个重复注解</span></span><br><span class="line"><span class="meta">@Role</span>(<span class="string">"MAN"</span>)</span><br><span class="line"><span class="meta">@Role</span>(<span class="string">"Child"</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span></span>{</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Role注解，允许重复使用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Inherited</span> <span class="comment">//Roles 和 Role 两个注解都要定义为可继承，否则子类无法获取父类的重复注解</span></span><br><span class="line"><span class="meta">@Repeatable</span>(Roles<span class="class">.<span class="keyword">class</span>) //声明该注解可重复使用，并指定该注解要放置的容器</span></span><br><span class="line"><span class="class">@<span class="title">Retention</span>(<span class="title">RetentionPolicy</span>.<span class="title">RUNTIME</span>)</span></span><br><span class="line"><span class="class">@<span class="title">Target</span>(<span class="title">ElementType</span>.<span class="title">TYPE</span>)</span></span><br><span class="line"><span class="class">@<span class="title">interface</span> <span class="title">Role</span></span>{</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Role注解的容器，接收相同的Role注解</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@Target</span>(ElementType.TYPE)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@interface</span> Roles{</span><br><span class="line">    Role[] value();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@cn</span>.annotation.Role(value=USER)</span><br><span class="line"><span class="meta">@cn</span>.annotation.Role(value=ADMIN)</span><br></pre></td></tr></tbody></table></figure>

<p>根据上面的说明，子类父类只能获取到其中之一的重复注解，我要获取父类的则必须把子类同名的重复注解注释：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Role("USER")</span></span><br><span class="line"><span class="comment">//@Role("ADMIN")</span></span><br></pre></td></tr></tbody></table></figure>

<p>此时我们再运行，结果为：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@cn</span>.annotation.Role(value=MAN)</span><br><span class="line"><span class="meta">@cn</span>.annotation.Role(value=Child)</span><br></pre></td></tr></tbody></table></figure>

<p>成功获取到父类的重复注解。</p>
<p>好了，本篇文章结束，谢谢大家阅读。</p>
<h2 id="5-参考链接"><a href="#5-参考链接" class="headerlink" title="5. 参考链接"></a>5. 参考链接</h2><ol>
<li><a href="https://blog.csdn.net/javazejian/article/details/71860633" target="_blank" rel="noopener">深入理解Java注解类型(@Annotation)</a></li>
<li><a href="https://blog.csdn.net/briblue/article/details/73824058" target="_blank" rel="noopener">秒懂，Java 注解 （Annotation）你可以这样学</a></li>
</ol>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            <hr>
          </div>
          <br>
          <div>
            <p>
            
              <span>
                <i class="iconfont icon-inbox"></i>
                
                  <a class="hover-with-bg" href="/categories/Java">Java</a>
                  &nbsp;
                
              </span>&nbsp;&nbsp;
            
            
              <span>
                <i class="iconfont icon-tag"></i>
                
                  <a class="hover-with-bg" href="/tags/Java">Java</a>
                
                  <a class="hover-with-bg" href="/tags/Java%20%E6%B3%A8%E8%A7%A3">Java 注解</a>
                
              </span>
            
            </p>
            
              <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
            
          </div>
        </div>
      </div>
    </div>
    <div class="d-none d-lg-block col-lg-2 toc-container">
      
  <div id="toc">
    <p class="h4"><i class="far fa-list-alt"></i>&nbsp;目录</p>
    <div id="tocbot"></div>
  </div>

    </div>
  </div>
</div>

<!-- custom -->


<!-- Comments -->
<div class="col-lg-7 mx-auto nopadding-md">
  <div class="container comments mx-auto" id="comments">
    
  </div>
</div>

    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  <footer class="mt-5">
  <div class="text-center py-3">
    <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a>
    <i class="iconfont icon-love"></i>
    <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"> <b>Fluid</b></a>
    <br>

    
  
    <!-- 不蒜子统计PV -->
    
    &nbsp;<span id="busuanzi_container_site_pv">总访问量 
          <span id="busuanzi_value_site_pv"></span> 次</span>&nbsp;
  
  
    <!-- 不蒜子统计UV -->
    
    &nbsp;<span id="busuanzi_container_site_uv">总访客数 
            <span id="busuanzi_value_site_uv"></span> 人</span>&nbsp;
  
  <br>



    

  </div>
</footer>

<!-- SCRIPTS -->
<script src="/lib/jquery/jquery.min.js" ></script>
<script src="/lib/popper/popper.min.js" ></script>
<script src="/lib/bootstrap/js/bootstrap.min.js" ></script>
<script src="/lib/mdbootstrap/js/mdb.min.js" ></script>
<script src="/js/main.js" ></script>


  <script src="/js/lazyload.js" ></script>



  
    <script src="/lib/tocbot/tocbot.min.js" ></script>
  
  <script src="/js/post.js" ></script>



  <script src="/lib/smooth-scroll/smooth-scroll.min.js" ></script>



  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>


<!-- Plugins -->


  

  

  

  

  




  <script src="/lib/prettify/prettify.min.js" ></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script src="/lib/typed/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Java基础加强：Java注解&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: true,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="/lib/anchor/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "false",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script src="/lib/fancybox/jquery.fancybox.min.js" ></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>







</body>
</html>
